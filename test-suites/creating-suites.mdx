---
title: "Creating Test Suites"
description: "Organize and manage collections of tests"
---

## What Is a Test Suite?

A test suite is a collection of related tests that share:

- A common service (Slack, Linear)
- A template/seed configuration
- Related functionality being tested

<Tip>
  **See real examples**: [Slack Bench](https://github.com/hubertpysklo/agent-diff/tree/main/examples/slack/testsuites) | [Linear Bench](https://github.com/hubertpysklo/agent-diff/tree/main/examples/linear/testsuites) | [HuggingFace Dataset](https://huggingface.co/datasets/hubertmarek/linear-bench-mini)
</Tip>

## Test Suite Structure

```json
{
  "id": "suite-123",
  "name": "Slack Bench",
  "description": "Core Slack agent capabilities",
  "templateService": "slack",
  "templateName": "slack_bench_default",
  "impersonateUserId": "U01AGENBOT9",
  "visibility": "public",
  "tests": [
    {
      "id": "test-001",
      "name": "Post message to channel",
      "prompt": "Post 'Hello World!' to #general",
      "expectedOutput": {
        "assertions": [...],
        "masks": ["created_at", "updated_at", "message_id"]
      },
      "tags": ["messages", "basic"]
    }
  ]
}
```

### Test Suite Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `name` | string | Yes | Name of the test suite |
| `description` | string | No | Description of what the suite tests |
| `templateService` | string | Yes | Service type: `"slack"` or `"linear"` |
| `templateName` | string | Yes | Template/seed to use |
| `impersonateUserId` | string | Yes | User ID the agent acts as |
| `visibility` | string | No | `"public"` or `"private"` (default) |

### Test Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `name` | string | Yes | Name of the test |
| `prompt` | string | Yes | Task prompt for the agent |
| `expectedOutput` | object | Yes | Expected assertions and masks |
| `tags` | array | No | Tags for filtering tests |

### Expected Output Structure

| Field | Type | Description |
|-------|------|-------------|
| `assertions` | array | List of assertions to evaluate |
| `masks` | array | Fields to ignore in diff comparison |
| `strict` | boolean | Fail if extra changes exist (default: false) |

## Listing Test Suites

```python
from agent_diff import AgentDiff

client = AgentDiff()

# List all suites
suites = client.list_test_suites()
for suite in suites.testSuites:
    print(f"- {suite.name} ({suite.id})")

# Filter by name
slack_suites = client.list_test_suites(name="Slack")
```

## Getting Suite Details

```python
# Get suite with test details
suite = client.get_test_suite(suite_id, expand=True)

print(f"Suite: {suite.name}")
print(f"Tests: {len(suite.tests)}")

for test in suite.tests:
    print(f"  - {test.name}: {test.prompt}")
```

## Creating Test Suites

```python
# Create a new test suite
suite = client.create_test_suite({
    "name": "My Agent Tests",
    "description": "Custom tests for my Slack agent",
    "templateService": "slack",
    "templateName": "slack_default",
    "impersonateUserId": "U01AGENBOT9",
    "visibility": "private"
})

print(f"Created suite: {suite.suiteId}")
```

## Adding Tests to a Suite

```python
# Add tests with assertions and masks
client.create_tests(suite.suiteId, {
    "tests": [
        {
            "name": "Post welcome message",
            "prompt": "Post a welcome message to #general",
            "tags": ["messages", "basic"],
            "expectedOutput": {
                "assertions": [{
                    "diff_type": "added",
                    "entity": "messages",
                    "where": {
                        "channel_id": {"eq": "C01GENERAL99"},
                        "message_text": {"contains": "welcome"}
                    },
                    "expected_count": 1
                }],
                "masks": ["ts", "message_id", "created_at"]
            }
        },
        {
            "name": "Create thread reply",
            "prompt": "Reply 'Got it!' to the latest message in #general",
            "tags": ["messages", "threading"],
            "expectedOutput": {
                "assertions": [{
                    "diff_type": "added",
                    "entity": "messages",
                    "where": {
                        "parent_id": {"not_null": true},
                        "message_text": {"eq": "Got it!"}
                    }
                }],
                "masks": ["ts", "message_id", "created_at"]
            }
        }
    ]
})
```

## Evaluation Without Test Suite

You can run evaluations without a pre-defined test suite by passing the expected output explicitly:

```python
from agent_diff import AgentDiff, PythonExecutorProxy, create_langchain_tool
from langchain.agents import create_agent

client = AgentDiff()

# Create environment directly with template
env = client.init_env(
    templateService="linear",
    templateName="linear_expanded",
    impersonateUserId="2790a7ee-fde0-4537-9588-e233aa5a68d1"
)

# Start run (no testId)
run = client.start_run(envId=env.environmentId)

# Run your agent...
agent = create_agent(
    model="claude-sonnet-4-5-20250929",
    tools=[create_langchain_tool(PythonExecutorProxy(env.environmentId))],
    system_prompt="Use execute_python to interact with Linear GraphQL API"
)

prompt = "Create a new issue titled 'Fix login bug' in the Engineering team"
agent.invoke({"messages": [{"role": "user", "content": prompt}]})

# Evaluate with explicit expected output
result = client.evaluate_run(
    runId=run.runId,
    expectedOutput={
        "assertions": [{
            "diff_type": "added",
            "entity": "issues",
            "where": {
                "title": {"contains": "Fix login bug"}
            }
        }],
        "masks": ["id", "created_at", "updated_at", "number", "sort_order"]
    }
)

print(f"{'PASSED' if result.passed else 'FAILED'}")
print(f"Score: {result.score}")

# Cleanup
client.delete_env(envId=env.environmentId)
```

## Running All Tests in a Suite

```python
from agent_diff import AgentDiff, PythonExecutorProxy, create_openai_tool
from agents import Agent, Runner

client = AgentDiff()

# Get suite
suite = client.get_test_suite("suite-123", expand=True)

results = []

for test in suite.tests:
    # Create environment for this test
    env = client.init_env(testId=test.id)
    run = client.start_run(envId=env.environmentId, testId=test.id)
    
    # Run agent
    executor = PythonExecutorProxy(env.environmentId, client.base_url)
    agent = Agent(
        name="Test Agent",
        tools=[create_openai_tool(executor)],
        instructions="Use execute_python to interact with Slack API..."
    )
    await Runner.run(agent, test.prompt)
    
    # Evaluate
    result = client.evaluate_run(runId=run.runId)
    
    results.append({
        "test": test.name,
        "passed": result.passed,
        "score": result.score,
        "failures": result.failures
    })
    
    # Cleanup
    client.delete_env(envId=env.environmentId)

# Summary
passed = sum(1 for r in results if r["passed"])
print(f"\n Results: {passed}/{len(results)} tests passed")

for r in results:
    status = "✓" if r["passed"] else "✗"
    print(f"  {status} {r['test']}")
    if r["failures"]:
        for f in r["failures"]:
            print(f"      └─ {f}")
```

## Test Visibility

| Visibility | Description                 |
| ---------- | --------------------------- |
| `public`   | Visible to all users        |
| `private`  | Only visible to the creator |

## Built-in Test Suites

### Slack Bench

20 tests covering:

- Message posting
- Channel operations
- Reactions
- Threading
- User mentions

### Linear Bench

40 tests covering:

- Issue creation/updates
- Label management
- Comments
- Workflow state transitions
- Team operations

## Next Steps

<CardGroup cols={2}>
  <Card title="Assertions" icon="pen" href="/core-concepts/assertions">
    Define expected outcomes with the DSL
  </Card>
  <Card title="Example Benchmarks" icon="chart-line" href="/test-suites/benchmarks">
    See built-in Slack and Linear suites
  </Card>
</CardGroup>